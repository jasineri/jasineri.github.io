/*
 Search v0.2.0 | (c) 2015 Nerijus Jasinskas */
(function(){this.getData=function(){function m(b,e){if(b.children)b.children.forEach(function(b){m(b,e)});else if(b.parent&&b.parent.children){var f=b.parent.children.filter(function(b){return h(b,1,e)||h(b,-1,e)});0<f.length?b.parent.children=f:(b.parent.children=null,m(b.parent,e))}}function h(b,e,f){if(b){if(0<b.depth&&0<=b.name.toLowerCase().indexOf(f.toLowerCase())||0>e&&h(b.parent,e,f))return!0;var d=b.children;d||(d=b.q);if(0<e&&d)for(b=0;b<d.length;++b)if(h(d[b],e,f))return!0}return!1}function q(b){var e=
d3.event&&d3.event.altKey?5E3:500,f=k.nodes(g).reverse();k.size([Math.max(150,Math.min(1950,11*f.length)),r]);f=k.nodes(g).reverse();f=f.filter(function(a){return 0!=a.depth});f.forEach(function(a){a.y=2>=a.depth?50*a.depth:80*a.depth});var d=v.selectAll("g.node").data(f,function(a){return a.id||(a.id=++w)}),c=d.enter().append("svg:g").attr("class","node").attr("transform",function(){return"translate("+b.y0+","+b.x0+")"}).on("click",function(a){a.children?(a.q=a.children,a.children=null):(a.children=
a.q,a.q=null);q(a)});c.append("svg:circle").attr("r",1E-6).style("fill",function(a){return a.q?"lightsteelblue":"#fff"});c.append("svg:text").attr("x",function(a){return 1>=a.depth?-10:10}).attr("dy",".35em").attr("text-anchor",function(a){return 1>=a.depth?"end":"start"}).text(function(a){return a.name}).style("fill-opacity",1E-6).style("font-weight",function(a){return 1>=a.depth?"bold":"normal"});c=d.transition().duration(e).attr("transform",function(a){return"translate("+a.y+","+a.x+")"});c.select("circle").attr("r",
4.5).style("fill",function(a){return a.q?"lightsteelblue":"#fff"});c.select("text").style("fill-opacity",1);d=d.exit().transition().duration(e).attr("transform",function(){return"translate("+b.y+","+b.x+")"}).remove();d.select("circle").attr("r",1E-6);d.select("text").style("fill-opacity",1E-6);d=v.selectAll("path.link").data(k.links(f),function(a){return a.target.id});d.enter().insert("svg:path","g").attr("class","link").attr("d",function(){var a={x:b.x0,y:b.y0};return n({source:a,target:a})}).transition().duration(e).attr("d",
n);d.transition().duration(e).attr("d",n);d.exit().transition().duration(e).attr("d",function(){var a={x:b.x,y:b.y};return n({source:a,target:a})}).remove();f.forEach(function(a){a.x0=a.x;a.y0=a.y})}jQuery("#fc").show();var p=jQuery("#ff"),s,t="",c=jQuery("#cf");c.off();p.off();c.click(function(){p.val("");p.trigger("keyup")});var c=[20,120,20,120],r=800-c[1]-c[3],u=2E3-c[0]-c[2],w=0,g,l,k=d3.layout.cluster().size([u,r]),n=d3.svg.diagonal().projection(function(b){return[b.y,b.x]}),v=d3.select("#pf").append("svg:svg").attr("width",
r+c[1]+c[3]).attr("height",u+c[0]+c[2]).append("svg:g").attr("transform","translate("+c[3]+","+c[0]+")");d3.json("../de/data/profile.json?v=48",function(b){l=b;l.x0=u/2;l.y0=0;g=jQuery.extend(!0,[],l);q(g);p.on("input propertychange keyup",function(){s=jQuery(this).val().toLowerCase();t!=s&&(t=s,g=jQuery.extend(!0,[],l),k.nodes(g),m(g,t),q(g))})})};jQuery(document).on("b",function(m,h){"srch"==h&&getData()});jQuery(document).trigger("j",["srch"])})();
